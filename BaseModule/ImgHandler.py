#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Time    : 2018/5/22 15:54
# @Author  : HT
# @Site    : 
# @File    : ImgHandler.py
# @Software: PyCharm Community Edition
# @Describe: Desc
# @Issues  : Issues
import base64, re


def base64_2_img(b64_str):
    '''

    :param b64_str: base64字符串
    :return: 编码后的img. type of bytes
    '''
    regexs = ['^data:image/jpeg;base64,(.*)', '^data:image/png;base64,(.*)']

    for regex in regexs:
        if re.match(regex, b64_str):
            b64_str = re.match(regex, b64_str).group(1)
    img = base64.b64decode(b64_str)
    return img

if __name__ == '__main__':
    img_src = 'data:image/jpeg;base64,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'
    img_bytes = base64_2_img(img_src)
    print(img_bytes)
    filer = open('1.jpg', 'wb')
    filer.write(img_bytes)
    filer.close()